---
title: "R Notebook"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---


```{r}
library(rayshader)
library(raster)
library(magrittr)
```


Ann Arbor

```{r}
tif <- raster("../data/N42W084.hgt")
cx <- -83.734
cy <- 42.280
r <- 0.07
ext <- extent(cx-r, cx+r, cy-r, cy+r)
city <- crop(tif, ext) 

elmat = matrix(extract(city, extent(city)),
               nrow=nrow(city),
               ncol=ncol(city))
z <- 100
model <- elmat %>%
  sphere_shade(texture = "imhof2") %>%
  add_water(detect_water(elmat)) %>%
  add_shadow(ray_shade(elmat, zscale=z, lambert=FALSE, anglebreaks = seq(65, 65, 1))) %>%
  add_shadow(lamb_shade(elmat, zscale=z)) 


```


```{r}
model %>% plot_map()
```


```{r}
model %>%
  plot_3d(elmat, zscale=10, soliddepth=-60, 
          windowsize = c(1200, 1200), 
          fov=60, 
          water=FALSE)
```

```{r}
save_3dprint("../output/seoul_3d.stl", maxwidth = 100, unit = "mm")
```

